<div class="container mt-4">
    <!-- T√≠tulo principal con dise√±o mejorado (MigueDks) -->
    <div class="text-center mb-5">
        <div class="position-relative d-inline-block">
            <!-- T√≠tulo con gradiente y dos √≠conos (MigueDks) -->
            <h1 class="display-4 fw-bold mb-0" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 50%, #28a745 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">
                <i class="bi bi-lightning-charge-fill me-3" style="color: #4facfe;"></i>
                Consulta de Energ√≠a Renovable
                <i class="bi bi-globe2 ms-3" style="color: #28a745;"></i>
            </h1>
            <!-- Fondo difuminado detr√°s del t√≠tulo (MigueDks) -->
            <div class="position-absolute top-0 start-0 w-100 h-100" style="background: linear-gradient(135deg, rgba(79,172,254,0.1) 0%, rgba(40,167,69,0.1) 100%); filter: blur(20px); z-index: -1; transform: scale(1.1);"></div>
        </div>
        <!-- Subt√≠tulo descriptivo con √≠conos (MigueDks) -->
        <p class="lead text-muted mt-3 mb-0">
            <i class="bi bi-graph-up text-primary me-2"></i>
            Explora y analiza datos de energ√≠a sostenible a nivel mundial
            <i class="bi bi-leaf text-success ms-2"></i>
        </p>
        <!-- Badges informativos sobre las funcionalidades (MigueDks) -->
        <div class="mt-3">
            <span class="badge bg-primary bg-opacity-10 text-primary px-3 py-2 me-2">
                <i class="bi bi-bar-chart me-1"></i>Gr√°ficas Interactivas
            </span>
            <span class="badge bg-success bg-opacity-10 text-success px-3 py-2 me-2">
                <i class="bi bi-calculator me-1"></i>Estad√≠sticas en Tiempo Real
            </span>
            <span class="badge bg-info bg-opacity-10 text-info px-3 py-2">
                <i class="bi bi-globe me-1"></i>Datos Globales
            </span>
        </div>
    </div>

    <!-- Secci√≥n 1: Gr√°fica de l√≠neas (Consumo) (MigueDks) -->
    <div class="card mb-5 shadow-sm">
        <!-- Encabezado de la tarjeta con t√≠tulo y badge de selecci√≥n (MigueDks) -->
        <div class="card-header text-white position-relative" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
            <h4 class="mb-0">
                <i class="bi bi-graph-up me-2"></i>üíß Evoluci√≥n del Consumo de Energ√≠a Renovable
            </h4>
            <!-- Badge que muestra pa√≠s y rango de a√±os seleccionados (MigueDks) -->
            <span ng-if="paisSeleccionado && desde && hasta" class="badge bg-light text-primary position-absolute top-50 end-0 translate-middle-y me-3">
                {{paisSeleccionado}} ({{desde}}-{{hasta}})
            </span>
        </div>
        <div class="card-body">
            <!-- Filtros para pa√≠s y rango de a√±os, con bot√≥n de reset (MigueDks) -->
            <div class="row align-items-end mb-4">
                <div class="col-md-4 mb-3">
                    <!-- Selector de pa√≠s (MigueDks) -->
                    <label class="form-label fw-bold">
                        <i class="bi bi-geo-alt-fill text-primary me-1"></i>Seleccione el pa√≠s
                    </label>
                    <div class="input-group">
                        <span class="input-group-text"><i class="bi bi-search"></i></span>
                        <select class="form-select" ng-model="paisSeleccionado" ng-options="p for p in paises"
                            ng-change="generarGrafica(paisSeleccionado, desde, hasta)">
                            <option value="">üåç Seleccione un pa√≠s...</option>
                        </select>
                    </div>
                </div>
                <div class="col-md-3 mb-3">
                    <!-- Input para a√±o inicial (MigueDks) -->
                    <label class="form-label fw-bold">
                        <i class="bi bi-calendar-event text-success me-1"></i>A√±o inicial
                    </label>
                    <input type="number" class="form-control text-center" ng-model="desde" min="1990" max="2023"
                        ng-change="generarGrafica(paisSeleccionado, desde, hasta)" placeholder="2000">
                </div>
                <div class="col-md-3 mb-3">
                    <!-- Input para a√±o final (MigueDks) -->
                    <label class="form-label fw-bold">
                        <i class="bi bi-calendar-check text-warning me-1"></i>A√±o final
                    </label>
                    <input type="number" class="form-control text-center" ng-model="hasta" min="1990" max="2023"
                        ng-change="generarGrafica(paisSeleccionado, desde, hasta)" placeholder="2020">
                </div>
                <div class="col-md-2 mb-3">
                    <!-- Bot√≥n para limpiar filtros (MigueDks) -->
                    <button class="btn btn-outline-secondary w-100" ng-click="limpiarFiltros()">
                        <i class="bi bi-arrow-clockwise me-1"></i>Reset
                    </button>
                </div>
            </div>

            <!-- Mensaje cuando no hay pa√≠s seleccionado (MigueDks) -->
            <div ng-if="!paisSeleccionado" class="text-center py-5">
                <i class="bi bi-graph-up text-muted" style="font-size: 4rem;"></i>
                <h5 class="text-muted mt-3">Selecciona un pa√≠s para visualizar los datos</h5>
                <p class="text-muted">Elige un pa√≠s y el rango de a√±os para generar la gr√°fica</p>
            </div>

            <!-- Mensaje cuando no hay datos disponibles (MigueDks) -->
            <div ng-if="sinDatos" class="text-center py-5">
                <i class="bi bi-exclamation-triangle text-warning" style="font-size: 4rem;"></i>
                <h5 class="text-warning mt-3">No hay datos disponibles</h5>
            </div>

            <!-- Gr√°fica de l√≠neas de consumo energ√©tico (MigueDks) -->
            <div ng-if="paisSeleccionado && !sinDatos" class="text-center">
                <canvas id="graficaEnergia" width="600" height="400"></canvas>
                <small class="text-muted mt-2 d-block">
                    <i class="bi bi-info-circle me-1"></i>Datos de energ√≠a renovable
                </small>
            </div>

            <!-- Indicadores estad√≠sticos del pa√≠s y periodo seleccionado (MigueDks) -->
            <div ng-if="estadisticas" class="row mt-4">
                <div class="col-md-3 mb-3">
                    <!-- Total generado de energ√≠a (MigueDks) -->
                    <div class="card text-center border-0 shadow-sm">
                        <div class="card-body" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                            <i class="bi bi-lightning-charge text-white fs-1"></i>
                            <h5 class="text-white mb-1 fw-bold">Total Generado</h5>
                            <h3 class="text-white mb-0 fw-bold">{{estadisticas.totalGeneral | number:1}} TWh</h3>
                        </div>
                    </div>
                </div>
                <div class="col-md-3 mb-3">
                    <!-- Energ√≠a dominante y porcentaje (MigueDks) -->
                    <div class="card text-center border-0 shadow-sm">
                        <div class="card-body" style="background: linear-gradient(135deg, #28a745 0%, #20c997 100%);">
                            <i class="bi bi-trophy text-white fs-1"></i>
                            <h5 class="text-white mb-1 fw-bold">Energ√≠a Dominante</h5>
                            <h6 class="text-white mb-0 fw-bold">{{estadisticas.energiaDominante}}</h6>
                            <small class="text-white fw-semibold">{{estadisticas.porcentajeDominante}}%</small>
                        </div>
                    </div>
                </div>
                <div class="col-md-3 mb-3">
                    <!-- Crecimiento porcentual (MigueDks) -->
                    <div class="card text-center border-0 shadow-sm">
                        <div class="card-body" style="background: linear-gradient(135deg, #ffa726 0%, #ffcc02 100%);">
                            <i class="bi bi-graph-up-arrow text-white fs-1"></i>
                            <h5 class="text-white mb-1 fw-bold">Crecimiento</h5>
                            <h4 class="text-white mb-0 fw-bold">{{estadisticas.crecimiento > 0 ? '+' : ''}}{{estadisticas.crecimiento | number:1}}%</h4>
                        </div>
                    </div>
                </div>
                <div class="col-md-3 mb-3">
                    <!-- Periodo y cantidad de a√±os analizados (MigueDks) -->
                    <div class="card text-center border-0 shadow-sm">
                        <div class="card-body" style="background: linear-gradient(135deg, #6f42c1 0%, #e83e8c 100%);">
                            <i class="bi bi-calendar-range text-white fs-1"></i>
                            <h5 class="text-white mb-1 fw-bold">Per√≠odo</h5>
                            <h6 class="text-white mb-0 fw-bold">{{estadisticas.periodo}}</h6>
                            <small class="text-white fw-semibold">{{estadisticas.anos}} a√±os</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Secci√≥n 2: Gr√°fica de dona (Distribuci√≥n de producci√≥n) (MigueDks) -->
    <div class="card mb-4 shadow-sm">
        <!-- Encabezado de la tarjeta con t√≠tulo y badge de selecci√≥n (MigueDks) -->
        <div class="card-header text-white position-relative" style="background: linear-gradient(135deg, #28a745 0%, #20c997 100%);">
            <h4 class="mb-0">
                <i class="bi bi-pie-chart me-2"></i>‚òÄÔ∏è Distribuci√≥n de la Producci√≥n de Energ√≠a Renovable
            </h4>
            <!-- Badge que muestra pa√≠s y rango de a√±os seleccionados (MigueDks) -->
            <span ng-if="paisProduccionSeleccionado && desdeProduccion && hastaProduccion" class="badge bg-light text-success position-absolute top-50 end-0 translate-middle-y me-3">
                {{paisProduccionSeleccionado}} ({{desdeProduccion}}-{{hastaProduccion}})
            </span>
        </div>
        <div class="card-body">
            <!-- Filtros para pa√≠s y rango de a√±os, con bot√≥n de reset (MigueDks) -->
            <div class="row align-items-end mb-4">
                <div class="col-md-4 mb-3">
                    <!-- Selector de pa√≠s para producci√≥n (MigueDks) -->
                    <label class="form-label fw-bold">
                        <i class="bi bi-geo-alt-fill text-success me-1"></i>Seleccione el pa√≠s
                    </label>
                    <div class="input-group">
                        <span class="input-group-text"><i class="bi bi-search"></i></span>
                        <select class="form-select" ng-model="paisProduccionSeleccionado"
                            ng-options="p for p in paisesProduccion"
                            ng-change="generarGraficaProduccion(paisProduccionSeleccionado, desdeProduccion, hastaProduccion)">
                            <option value="">üåç Seleccione un pa√≠s...</option>
                        </select>
                    </div>
                </div>
                <div class="col-md-3 mb-3">
                    <!-- Input para a√±o inicial de producci√≥n (MigueDks) -->
                    <label class="form-label fw-bold">
                        <i class="bi bi-calendar-event text-primary me-1"></i>A√±o inicial
                    </label>
                    <input type="number" class="form-control text-center" ng-model="desdeProduccion" min="1990" max="2023"
                        ng-change="generarGraficaProduccion(paisProduccionSeleccionado, desdeProduccion, hastaProduccion)" placeholder="2000">
                </div>
                <div class="col-md-3 mb-3">
                    <!-- Input para a√±o final de producci√≥n (MigueDks) -->
                    <label class="form-label fw-bold">
                        <i class="bi bi-calendar-check text-warning me-1"></i>A√±o final
                    </label>
                    <input type="number" class="form-control text-center" ng-model="hastaProduccion" min="1990" max="2023"
                        ng-change="generarGraficaProduccion(paisProduccionSeleccionado, desdeProduccion, hastaProduccion)" placeholder="2020">
                </div>
                <div class="col-md-2 mb-3">
                    <!-- Bot√≥n para limpiar filtros de producci√≥n (MigueDks) -->
                    <button class="btn btn-outline-secondary w-100" ng-click="limpiarFiltrosProduccion()">
                        <i class="bi bi-arrow-clockwise me-1"></i>Reset
                    </button>
                </div>
            </div>

            <!-- Leyenda de colores para tipos de energ√≠a renovable (MigueDks) -->
            <div ng-if="paisProduccionSeleccionado" class="row mb-4">
                <div class="col-md-3">
                    <div class="d-flex align-items-center">
                        <div class="rounded-circle me-2" style="width: 20px; height: 20px; background: #4facfe;"></div>
                        <span>üíß Hidroel√©ctrica</span>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="d-flex align-items-center">
                        <div class="rounded-circle me-2" style="width: 20px; height: 20px; background: #ffa726;"></div>
                        <span>‚òÄÔ∏è Solar</span>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="d-flex align-items-center">
                        <div class="rounded-circle me-2" style="width: 20px; height: 20px; background: #28a745;"></div>
                        <span>üí® E√≥lica</span>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="d-flex align-items-center">
                        <div class="rounded-circle me-2" style="width: 20px; height: 20px; background: #6f42c1;"></div>
                        <span>üå± Otras Renovables</span>
                    </div>
                </div>
            </div>

            <!-- Mensaje cuando no hay pa√≠s seleccionado para producci√≥n (MigueDks) -->
            <div ng-if="!paisProduccionSeleccionado" class="text-center py-5">
                <i class="bi bi-pie-chart text-muted" style="font-size: 4rem;"></i>
                <h5 class="text-muted mt-3">Selecciona un pa√≠s para visualizar la distribuci√≥n</h5>
                <p class="text-muted">Elige un pa√≠s y el rango de a√±os para generar la gr√°fica de dona</p>
            </div>

            <!-- Mensaje cuando no hay datos de producci√≥n disponibles (MigueDks) -->
            <div ng-if="sinDatosProduccion" class="text-center py-5">
                <i class="bi bi-exclamation-triangle text-warning" style="font-size: 4rem;"></i>
                <h5 class="text-warning mt-3">No hay datos de producci√≥n disponibles</h5>
            </div>

            <!-- Gr√°fica de dona de distribuci√≥n energ√©tica (MigueDks) -->
            <div ng-if="paisProduccionSeleccionado && !sinDatosProduccion" class="text-center">
                <div class="row justify-content-center">
                    <div class="col-lg-8">
                        <canvas id="graficaProduccionEnergia" width="400" height="400"></canvas>
                        <small class="text-muted mt-2 d-block">
                            <i class="bi bi-info-circle me-1"></i>Distribuci√≥n de energ√≠as renovables
                        </small>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>